<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
<link rel="home" href="http://iguana.cern.ch/">
<link rev="made" href="mailto:iguana-developers@cern.ch">
<link rel="stylesheet" href="../weblayout.css" type="text/css">
<meta name="originator" content="IGUANA Developers">
<meta http-equiv="Reply-to" content="iguana-developers@cern.ch">
<meta http-equiv="Keywords" content="LHC, CMS, IGUANA, interactive,
  graphics, visualisation, toolkit, event display, OpenGL, OpenInventor,
  developer guide, gl2ps, 2D culling, culling, BSP tree">

<title>GL2PS 2D Culling Improvements</title>
</head>
<body bgcolor="#ffffff">
  
<div align="center">
<center> 
<h1> <b><font size="+4">GL2PS Results</font></b><br>
</h1>
</center>
</div>
<table border="2" cellspacing="2" cellpadding="2" width="90%"
 align="center">
 <caption><br>
  </caption><tbody>
 
  </tbody>  <tbody>
    <tr>
 <td align="center" valign="top"><b>S. No</b></td>
  <td align="center" valign="top"><b>2D BSP Culling</b></td>
  <td align="center" valign="top"><b>Actual Prim added in 2D BSP Tree</b></td>
  <td align="center" valign="top"><b>Checks for Coincident Prim</b></td>
  <td align="center" valign="top"><b>Lines first for 2D Culling</b></td>
  <td align="center" valign="top"><b>Total Primitives</b></td>
  <td align="center" valign="top"><b>Dropped Primitives</b></td>
  <td align="center" valign="top"><b>Added Primitives</b></td>
  <td align="center" valign="top"><b>Nodes in 2D BSP Culling Tree</b></td>
  <td align="center" valign="top"><b>File Size</b> <br>
      <b>(KByte)</b></td>
  <td valign="top" align="center"><b>% Reduction</b></td>
 </tr>
  <tr>
 <td valign="top">1</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">N/A</td>
  <td align="center" valign="top">N/A</td>
  <td align="center" valign="top">N/A</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">N/A</td>
  <td align="right" valign="top">N/A</td>
  <td align="right" valign="top">N/A</td>
  <td align="right" valign="top">34659</td>
  <td align="right" valign="top">N/A</td>
 </tr>
  <tr>
 <td valign="top">2</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">NO</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">675748</td>
  <td align="right" valign="top">5627</td>
  <td align="right" valign="top">64025</td>
  <td align="right" valign="top">311</td>
  <td align="right" valign="top">99.1%</td>
 </tr>
  <tr>
 <td valign="top">3</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">NO</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">678390</td>
  <td align="right" valign="top">2985</td>
  <td align="right" valign="top">28068</td>
  <td align="right" valign="top">161/td>
  <td align="right" valign="top">99.5%</td>
 </tr>
  <tr>
 <td valign="top">4</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">643385</td>
  <td align="right" valign="top">37990</td>
  <td align="right" valign="top">64048</td>
  <td align="right" valign="top">2086</td>
  <td align="right" valign="top">93.4%</td>
 </tr>
  <tr>
 <td valign="top">5</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">677673</td>
  <td align="right" valign="top">3702</td>
  <td align="right" valign="top">28068</td>
  <td align="right" valign="top">201</td>
  <td align="right" valign="top">99.4%</td>
 </tr>
  <tr>
 <td valign="top">6</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">YES</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">677071</td>
  <td align="right" valign="top">4304</td>
  <td align="right" valign="top">35943</td>
  <td align="right" valign="top">228</td>
  <td align="right" valign="top">99.3%</td>
 </tr>
  <tr>
 <td valign="top">7</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">NO</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">610384</td>
  <td align="right" valign="top">70991</td>
  <td align="right" valign="top">67662</td>
  <td align="right" valign="top">3894</td>
  <td align="right" valign="top">88.7%</td>
 </tr>
  <tr>
 <td valign="top">8</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="center" valign="top">YES</td>
  <td align="right" valign="top">681375</td>
  <td align="right" valign="top">675084</td>
  <td align="right" valign="top">6291</td>
  <td align="right" valign="top">35946</td>
  <td align="right" valign="top">336</td>
  <td align="right" valign="top">99.0%</td>
 </tr>
 
  </tbody>
</table>
  &nbsp; 
<ul>
 <li> When we add the actual primitive(DEF) instead of splited one(DEHJ or
BHFI) in the 2D BSP tree then the number of nodes in the 2D BSP tree reduces 
which means less usage of memory and less time to decide a primitive should 
be culled or not.</li>
 
</ul>
  
<center><img src="../images/gl2ps/fig1.jpg" alt="2D BSP Culling Tree" height="327"
 width="626">
</center>
  
<ul>
 <li> As in the coplanar primitives list, triangles come first that's why
when we go from front to back ( for 2D culling ) we need to check lines first. 
In the old implementation we checked the triangles first that's why most of
the coplanar lines were culled during 2D culling operation. The increase in
number of "<b>Added Primitives</b>" shows that there were some primitives 
dropped when we processed triangles first for culling. Iteration in reverse 
order for coplanar primitives when moving from front to back gives much better
results.</li>
 
</ul>
  
<ul>
 <li> In the old implementation when a primitive is coincident with the plane 
represented by a node of the 2D BSP tree then we culled this primitive if
it has more then 2 vertex otherwise we keep it (assuming that this line is
representing a vertex of a polygon). This was a bug because this way we might
drop some primitives which were visible and also we might add some primitives
which were although coincident to one node but they might be invisible due
to other primitives. In fig B triangle JKL was dropped in the old implementaion
because it was coincident to the plane represented by the node AC but this
triangle is visible. Similerly the line MN was added in the old implementation
because it is coincident to plane represented by nodes AB and PR and point
O was also added as it was coincident to both planes represented BC and QB.
As now instead of spilted primitive we add the whole actual primitive so
line MN and point O will be culled by the triangle DEF</li>
 
</ul>
  
<center><img src="../images/gl2ps/fig2.jpg" alt="Coincident primitives" height="319"
 width="663">
</center>
  <br>
&nbsp; <br>
</body>
</html>
