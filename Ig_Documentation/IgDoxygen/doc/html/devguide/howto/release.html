<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
<link rel="home" href="http://iguana.cern.ch/">
<link rev="made" href="mailto:iguana-developers@cern.ch">
<link rel="stylesheet" href="../../weblayout.css" type="text/css">
<meta name="originator" content="IGUANA Developers">
<meta http-equiv="Reply-to" content="iguana-developers@cern.ch">
<meta http-equiv="Keywords" content="LHC, CMS, IGUANA, interactive,
  graphics, visualisation, toolkit, event display, OpenGL, OpenInventor,
  how to, release">

<title>IGUANA Developer Guide: How To Release IGUANA</title>
</head>

<body bgcolor="#ffffff">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
 <!-- Top icon: fixes navigation bar width -->
 <td align="left" valign="top"><table width="100%" border="0">
  <tr><td><img src="../../images/pad.gif" width="20" height="1" alt=""></td>
   <td valign="top"><img src="../../images/mini.gif" width="98" height="64"
     border="0" alt="Yo!"></td>
   <td><img src="../../images/pad.gif" width="70" height="1" alt="*"></tr></table></td>

 <!-- Top banner: title -->
 <td colspan="2"><table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr><td align="left" colspan="2"><font face="Arial, Helvetica" size="-1">
     <font color="#FF00FF">I</font><font color="#009900">nteractive</font>
     <font color="#FF00FF">G</font><font color="#009900">raphics</font>
     <font color="#009900">For</font>
     <font color="#FF00FF">U</font><font color="#009900">ser</font>
     <font color="#FF00FF">ANA</font><font color="#009900">lysis</font>
     <font color="#0020FF">(Version @VERSNUM@)</font></td></tr>
  <tr valign="bottom"><td align="left"><img src="../../images/title.gif" width="208"
    height="62"  border="0" alt="IGUANA"></td>
   <td align="right"><font face="Arial, Helvetica" size="+2"><b>
    Developer Guide:<br>How To Release IGUANA</b></font></td></tr>
  <tr><td colspan="2" align="left"><hr align="left" noshade="noshade"></td></tr>
 </table></td></tr>

<tr valign="top"><td>
 <!-- Left context navigation bar. -->
 <!-- Navigation button row. -->
 <table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
   <td align="left"><a href="../howto/"><img src="../../images/arrow-up.gif"
    width="34" height="34" alt="[Up]" border="0"></a></td>
   <td align="right"><a href="other-projects.html"><img src="../../images/arrow-left.gif"
    width="34" height="34" alt="[Prev]" border="0"></a>
    <a href="debug.html"><img src="../../images/arrow-right.gif"
    width="34" height="34" alt="[Next]" border="0"></a></td></tr>
 </table></td>
 <td>&nbsp;</td>
 <td>&nbsp;</td></tr>

<tr valign="top"><td bgcolor="#ffffdd">
 <!-- Navigation bar. -->
 <table width="100%" border="0" cellspacing="0" cellpadding="1">
  <tr><td class="nav1"><img src="../../images/pad.gif"
    width="10" height="1" hspace="2" alt=" "></td>
   <td class="nav1" colspan="3"><b>Quick Links</b></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../../../releases.html">Releases</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../../main/lxr.html">LXR Index</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="http://isscvs.cern.ch/cgi-bin/viewcvs.cgi/?cvsroot=iguana">CVS</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../../main/faqs.html">FAQs</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../../main/problems.html">Problems?</a></td></tr>

  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><b><a
   href="../../index.html">IGUANA</a></b></td></tr>

  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><b><a
   href="../../install/">Installation</a></b></td></tr>

  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><b><a
   href="../../userguide/">User Guide</a></b></td></tr>

  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><b><a
   href="../../devguide/">Developer Guide</a></b></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../conventions.html">Conventions</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../deps.html">Dependencies</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../arch.html">Architecture</a></td></tr>
  <tr><td class="nav2">&nbsp;</td><td class="nav2">&nbsp;&nbsp;</td>
   <td class="nav2" colspan="2"><a href="../howto/">How To...?</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="build.html">Build</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-package.html">Create a Package</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-plugin.html">Create a Plug-in</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-driver.html">Create a Driver</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-service.html">Create a Service</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-model.html">Create a Model</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-browser.html">Create a Browser</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-representable.html">Create a Representable</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="new-repmap.html">Create a Rep Mapping</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="update-config.html">Update Configuration</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="other-projects.html">Work With Other Projects</a></td></tr>
  <tr><td class="nav3s">&nbsp;</td><td class="nav3s">&nbsp;&nbsp;</td>
   <td class="nav3s"><img src="../../images/marker.gif"
    width="10" height="10" hspace="2" alt="&gt;"></td>
   <td class="nav3s">Release IGUANA</td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="debug.html">Debug</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="webpages.html">Update Web Pages</a></td></tr>
  <tr><td class="nav3">&nbsp;</td><td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3">&nbsp;&nbsp;</td>
   <td class="nav3"><a href="screenshot.html">Make a Screen Shot</a></td></tr>

  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><b><a
   href="../../apiref/">API Reference</a></b></td></tr>

  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><b><a
   href="../../info/">More Information</a></b></td></tr>

  <tr><td class="nav1">&nbsp;</td>
   <td class="nav1" colspan="3"><hr noshade="noshade" border="1"></td></tr>
  <tr><td class="nav1">&nbsp;</td><td class="nav1" colspan="3"><form
    method="get" action="http://www.google.com/custom">
    <font face="Helvetica, Arial, Sans-Serif" size="-1">
     <a href="http://www.google.com/search"><img src="../../images/google.gif" border="0"
      alt="Google Search" width="16" height="16"></a>
     <input type="text" name="q" size="11">
     <input type="hidden" name="cof"
     value="LW:98;L:http://iguana.cern.ch/snapshot/images/mini.gif;LH:64;AH:center;S:http://iguana.cern.ch;AWFID:9ebb11a906c88373;">
     <input type="hidden" name="domains" value="iguana.web.cern.ch">
     <input type="hidden" name="sitesearch" value="iguana.web.cern.ch">
     <b><input value="Search" type="submit"></b></font></form>
     <!-- <br><input type="radio" name="sitesearch" value="" checked> Search WWW
      <input type="radio" name="sitesearch" value="iguana.web.cern.ch"> Search IGUANA</font> -->
    </form>
   </td></tr></table>
</td>
<td>&nbsp;</td>

<td width="100%" align="left" valign="top">
 <h3>Releasing IGUANA with SCRAM</h3>
 <div class="sect1"><p>Building IGUANA reference releases at CERN needs
   to be 100% reproducible, and as a means of guaranteeing that, please
   alway follow the prodecure described below.  Should the build fail
   for any reason, even for a triviality such as running out of disk
   space, start from scratch.  If these instruction do not work, update
   the build scripts or these instructions.</p>

   <ul>
     <li> <a href="#prepare">Step 1. Prepare for the release</a>
     <li> <a href="#login">Step 2. Login on the main build machine</a>
     <li> <a href="#build">Step 3. Build the release</a>
     <li> <a href="#test">Step 4. Test the release</a>
     <li> <a href="#install">Step 5. Install and announce the release</a>
   </ul>
 </div>

 <h3><a name="prepare"></a>Prepare for the release</h3>
 <div class="sect1"><p>The first step of the release build is to get
  prepared.  This involves <em>announcing the intention to release</em>
  to the other developers, <em>requesting an AFS volume</em> and
  <em>tagging the release.</em></p>

  <p>When you plan to make a release, please send a notification to
  <a href="mailto:iguana-developers@cern.ch">IGUANA developers</a> a
  few days in advance.  Collect tags for the release and check the
  code and the build procedure in your developer's area.  Run the
  integration tests as they would be run in the release.  The easiest
  way to do all this is to <a href="#build">build as if in the release
  area</a>.

  <p>To tag the release, check out the code you want to go into the
  release in <tt>config</tt> and <tt>src</tt> directories.  Normally
  you should take the full head of the tree except for the top-level
  <tt>Ig_Utilities</tt> and <tt>domain</tt> directories.  Before you
  tag, you need to make a few updates, and then tag the code:</p>
  <ul>
    <li> Update the <tt>config</tt> directory
         <ul>
           <li> Update <tt>BootStrapFile</tt> and <tt>BootStrapFileSRC</tt>
                to specify the correct CVS tags and version numbers.  Tags
                and version numbers should be <tt>@LAST_VERSION@</tt>.
	   <li> Update <tt>RequirementsDoc</tt> to refer to the correct
		CMS configuration (<tt>CMS_XX_1</tt>).
	   <li> Update <tt>scram_version</tt> if necessary.
	   <li> Commit the changes:
		<pre>cvs ci -m "Configuration for @LAST_VERSION@"</pre>
	 </ul>

    <li> Update <tt>Ig_Documentation/IgDoxygen/doc/html/main/relnotes.html</tt>.
	 The notes should include a paragraph that gives a succint summary of
	 all the changes, and then a bullet for each changed package together
	 with a brief summary of the changes.<br><br>

    <li> Update <tt>Ig_Documentation/IgDoxygen/doc/html/devguide/deps.html</tt>
         to have a link for each SCRAM architecture for which this IGUANA version
	 is going to be release.<br><br>

    <li> Tag the tree:
	 <pre>cvs tag @LAST_VERSION@ config src</pre>

    <li> If there are post-tag commits to catch up with, move the tag with:
         <pre>cvs tag -F @LAST_VERSION@</pre>
  
         <p>If any non-trivial changes are required to the tag, that is,
	 anything more than moving the tag for one or two fiels, remove
	 the tag completely (with "<tt>cvs rtag -d @LAST_VERSION@ IGUANA
         config</tt>") and retag.  <i>If there is any doubt that wrong
	 code has been tagged, always remove the tag completely -- do
	 <b>not</b> patch up!</i>
  </ul>
  
  <p>Each IGUANA release is built on an AFS volume of its own.  Request a new
  1 GB AFS volume <tt>/afs/cern.ch/cms/Releases/IGUANA/@LAST_VERSION@</tt>
  with permissions identical to the parent directory.</p>
 </div>

 <h3><a name="login"></a>Login on the main build machine</h3>
  <div class="sect1"><p>Login as <tt>cmscan</tt> on a linux host (on
  <tt>lxplus</tt> for the CERN reference builds).</p></div>

 <h3><a name="build"></a>Build the release</h3>
  <div class="sect1">
   <pre>cd /afs/cern.ch/cms/Releases/IGUANA
cmscvsroot IGUANA
cvs co -p -r @LAST_VERSION@ \
  Ig_Infrastructure/IgBuildScripts/src/make-release > make-release
sh ./make-release @LAST_VERSION@</pre>
  
   <p>This updates the <tt>config</tt> directory in the current directory for
   IGUANA @VERSNUM@, does <tt>scram project</tt> using <tt>BootStrapFileSRC</tt>
   to create the release directory.  Note that creating the AFS volume above
   creates a directory which you should not remove; to clear up, delete all its
   contents but not the volume mount point itself.</p>
  
   <p>It then launches the full build on the current host. Once the build is complete,
   it will run all the test programs; you'll need an X display for these. Documentation
   is built automatically, and at the end, it cleans up the <tt>tmp</tt> tree and 
   write-protects the directories against accidental modification.  The script has
   a number of options to skip specific steps to do only a partial build.  Do not 
   use them with the CERN reference builds; for other builds you will normally want
   to first do the project checkout and interactive setup and only then go to the 
   full build, as follows (again, the last step will require an X display):</p>
  
   <pre><span class="comment"># 1) Project checkout and setup on linux host (linuxhost)</span>
sh ./make-release -s -b -t -d -c @LAST_VERSION@</pre>
   
 <h3><a name="test"></a>Test the release</h3>
  <div class="sect1"><p>This step applies only to the reference builds at CERN.
   Before releasing IGUANA, check the log files in the @LAST_VERSION@/logs 
   directory for any errors, make sure all the test programs run correctly 
   during the release build. If the IGUANA release fails to work correctly, 
   blast it and the associated tags away, make the required corrections in a 
   private development area and roll out a new release once all works
   correctly. The things that are required to work are:
   <ul>
     <li> Test all basic dialogs (setting background colours, ...)
     <li> Test saving and printing of scenes.
   </ul>
  </div>

 <h3><a name="install"></a>Install and announce the release</h3>
  <div class="sect1"><p>Once the release is complete and tested, install
   it in the SCRAM project database.  At CERN reference builds,
   <a href="mailto:Shaun.Ashby@cern.ch?subject=Please%20scram%20install%20@LAST_VERSION@"><!--
   -->send a request to the librarian</a>.  Otherwise simply invoke
   <tt>scram install</tt> in the project release.</p>

   <p>Notify the AFS volume maintainer (Anita Bjorkebo) that the release
   volume is now static and free space can be reclaimed.</p>

   <p>Next, update <tt>Ig_Documentation/IgDoxygen/doc/html/releases.html</tt>
   and commit the change.  The top web pages will update on the next snapshot
   update.  You can force the update by running this as <tt>cmscan</tt>:
   <pre>cd /afs/cern.ch/cms/Releases/IGUANA/snapshot/src && scram b snapshot</pre>

   <p>Finally, 
   <a href="mailto:iguana-developers@cern.ch?subject=IGUANA%20@VERSNUM@%20released"><!--
   -->send a mail to <tt>iguana-developers@cern.ch</tt></a> to announce
   the release.  Append the release notes to the mail; easiest way to capture
   them is the use a text browser such as w3m with about 70 character-wide
   terminal and paste the formatted text into the mail editor.</p>
  </div>
 </td></tr>
<tr>
 <td bgcolor="#ffffdd"><table border="0" width="100%"><tr>
   <td align="left"><a href="mailto:iguana-developers@cern.ch"><img
    src="../../images/mailto.gif" border="0" width="14" height="10"
    alt="[Mail]"></a></td>
   <td align="right"><font face="Arial, Helvetica"
    size="-2">$Date: 2006/09/11 07:45:25 $</font></td></tr></table></td>
 <td><font face="Arial, Helvetica" size="-2">&nbsp;</font></td>
 <td><font face="Arial, Helvetica" size="-2">&nbsp;</font></td></tr>
</table>
</body>
</html>
